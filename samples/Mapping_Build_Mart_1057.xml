<?xml version="1.0" encoding="UTF-8"?>
<POWERMART VERSION="180.0" CREATION_DATE="2025-08-28 10:05:00" REPOSITORY_VERSION="181.0">
  <REPOSITORY NAME="Repo_DEV" VERSION="181.0" CODEPAGE="UTF-8" DATABASETYPE="Oracle">
    <FOLDER NAME="ClaimsFolder" DESCRIPTION="" OWNER="dev" SHARED="NOTSHARED" PERMISSIONS="rwx">
      <MAPPING NAME="m_Build_Mart" DESCRIPTION="Join staged claims with payments and compute balance">
        <SOURCE NAME="NET_CLAIMS" DBDNAME="TMP" OWNERNAME="STG">
          <FIELD NAME="CLAIM_ID" DATATYPE="integer"/>
          <FIELD NAME="NET_AMT" DATATYPE="decimal(12,2)"/>
        </SOURCE>
        <SOURCE NAME="PAID" DBDNAME="DB2" OWNERNAME="SRC">
          <FIELD NAME="CLAIM_ID" DATATYPE="integer"/>
          <FIELD NAME="PAID_AMT" DATATYPE="decimal(12,2)"/>
        </SOURCE>

        <TRANSFORMATION NAME="JNR_Claims_Paid" TYPE="Joiner" REUSABLE="NO">
          <TRANSFORMFIELD NAME="CLAIM_ID_L" PORTTYPE="INPUT" DATATYPE="integer"/>
          <TRANSFORMFIELD NAME="NET_AMT_L"  PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="CLAIM_ID_R" PORTTYPE="INPUT" DATATYPE="integer"/>
          <TRANSFORMFIELD NAME="PAID_AMT_R" PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="CLAIM_ID"   PORTTYPE="OUTPUT" DATATYPE="integer"         EXPRESSION="CLAIM_ID_L"/>
          <TRANSFORMFIELD NAME="NET_AMT"    PORTTYPE="OUTPUT" DATATYPE="decimal(12,2)"   EXPRESSION="NET_AMT_L"/>
          <TRANSFORMFIELD NAME="PAID_AMT"   PORTTYPE="OUTPUT" DATATYPE="decimal(12,2)"   EXPRESSION="PAID_AMT_R"/>
          <TABLEATTRIBUTE NAME="Join Condition" VALUE="NET_CLAIMS.CLAIM_ID = PAID.CLAIM_ID"/>
        </TRANSFORMATION>

        <TRANSFORMATION NAME="EXP_FACT" TYPE="Expression" REUSABLE="NO">
          <TRANSFORMFIELD NAME="CLAIM_ID" PORTTYPE="INPUT" DATATYPE="integer"/>
          <TRANSFORMFIELD NAME="NET_AMT"  PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="PAID_AMT" PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="BALANCE"  PORTTYPE="OUTPUT" DATATYPE="decimal(12,2)" EXPRESSION="NET_AMT - PAID_AMT"/>
        </TRANSFORMATION>

        <TARGET NAME="FACT_CLAIM" DBDNAME="MART" OWNERNAME="DW">
          <FIELD NAME="CLAIM_ID" DATATYPE="integer"/>
          <FIELD NAME="NET_AMT" DATATYPE="decimal(12,2)"/>
          <FIELD NAME="PAID_AMT" DATATYPE="decimal(12,2)"/>
          <FIELD NAME="BALANCE" DATATYPE="decimal(12,2)"/>
        </TARGET>

        <CONNECTOR FROMINSTANCE="NET_CLAIMS" FROMPORT="CLAIM_ID" TOINSTANCE="JNR_Claims_Paid" TOPORT="CLAIM_ID_L"/>
        <CONNECTOR FROMINSTANCE="NET_CLAIMS" FROMPORT="NET_AMT"  TOINSTANCE="JNR_Claims_Paid" TOPORT="NET_AMT_L"/>
        <CONNECTOR FROMINSTANCE="PAID" FROMPORT="CLAIM_ID"      TOINSTANCE="JNR_Claims_Paid" TOPORT="CLAIM_ID_R"/>
        <CONNECTOR FROMINSTANCE="PAID" FROMPORT="PAID_AMT"      TOINSTANCE="JNR_Claims_Paid" TOPORT="PAID_AMT_R"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="CLAIM_ID" TOINSTANCE="EXP_FACT" TOPORT="CLAIM_ID"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="NET_AMT"  TOINSTANCE="EXP_FACT" TOPORT="NET_AMT"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="PAID_AMT" TOINSTANCE="EXP_FACT" TOPORT="PAID_AMT"/>
        <CONNECTOR FROMINSTANCE="EXP_FACT" FROMPORT="BALANCE"   TOINSTANCE="FACT_CLAIM" TOPORT="BALANCE"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="CLAIM_ID" TOINSTANCE="FACT_CLAIM" TOPORT="CLAIM_ID"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="NET_AMT"  TOINSTANCE="FACT_CLAIM" TOPORT="NET_AMT"/>
        <CONNECTOR FROMINSTANCE="JNR_Claims_Paid" FROMPORT="PAID_AMT" TOINSTANCE="FACT_CLAIM" TOPORT="PAID_AMT"/>
      </MAPPING>
    </FOLDER>
  </REPOSITORY>
</POWERMART>
