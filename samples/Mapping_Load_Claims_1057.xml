<?xml version="1.0" encoding="UTF-8"?>
<POWERMART VERSION="180.0" CREATION_DATE="2025-08-28 10:00:00" REPOSITORY_VERSION="181.0">
  <REPOSITORY NAME="Repo_DEV" VERSION="181.0" CODEPAGE="UTF-8" DATABASETYPE="Oracle">
    <FOLDER NAME="ClaimsFolder" DESCRIPTION="" OWNER="dev" SHARED="NOTSHARED" PERMISSIONS="rwx">
      <MAPPING NAME="m_Load_Claims" DESCRIPTION="Compute NET_AMT and land to stage">
        <TRANSFORMATION NAME="EXP_NET" TYPE="Expression" REUSABLE="NO">
          <TRANSFORMFIELD NAME="GROSS" PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="DISCOUNT" PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="TAX" PORTTYPE="INPUT" DATATYPE="decimal(12,2)"/>
          <TRANSFORMFIELD NAME="NET_AMT" PORTTYPE="OUTPUT" DATATYPE="decimal(12,2)"
            EXPRESSION="IIF(ISNULL(DISCOUNT), GROSS + TAX, GROSS - DISCOUNT + TAX)"/>
        </TRANSFORMATION>

        <SOURCE NAME="CLAIMS" DBDNAME="DB2" OWNERNAME="SRC">
          <FIELD NAME="CLAIM_ID" DATATYPE="integer"/>
          <FIELD NAME="GROSS" DATATYPE="decimal(12,2)"/>
          <FIELD NAME="DISCOUNT" DATATYPE="decimal(12,2)"/>
          <FIELD NAME="TAX" DATATYPE="decimal(12,2)"/>
        </SOURCE>

        <TARGET NAME="NET_CLAIMS" DBDNAME="TMP" OWNERNAME="STG">
          <FIELD NAME="CLAIM_ID" DATATYPE="integer"/>
          <FIELD NAME="NET_AMT" DATATYPE="decimal(12,2)"/>
        </TARGET>

        <CONNECTOR FROMINSTANCE="CLAIMS" FROMPORT="GROSS" TOINSTANCE="EXP_NET" TOPORT="GROSS"/>
        <CONNECTOR FROMINSTANCE="CLAIMS" FROMPORT="DISCOUNT" TOINSTANCE="EXP_NET" TOPORT="DISCOUNT"/>
        <CONNECTOR FROMINSTANCE="CLAIMS" FROMPORT="TAX" TOINSTANCE="EXP_NET" TOPORT="TAX"/>
        <CONNECTOR FROMINSTANCE="EXP_NET" FROMPORT="NET_AMT" TOINSTANCE="NET_CLAIMS" TOPORT="NET_AMT"/>
        <CONNECTOR FROMINSTANCE="CLAIMS" FROMPORT="CLAIM_ID" TOINSTANCE="NET_CLAIMS" TOPORT="CLAIM_ID"/>
      </MAPPING>
    </FOLDER>
  </REPOSITORY>
</POWERMART>
